<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">

  <!-- MOBIL UCHUNgit add . MUHIM -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Olmaliq KMK AJ o'quv markazi Muhandislik maktabi</title>

  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      min-height: 100vh;
      background:
        linear-gradient(rgba(0,0,0,0.55), rgba(0,0,0,0.55)),
        url("bg-school.jpg") center / cover no-repeat;
      display: flex;
      justify-content: center;
      align-items: center;
      padding-top: 120px;
    }

    /* ===== HEADER ===== */
    header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #1b2f3a;
      color: #fff;
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 10px 20px;
      z-index: 1000;
    }

    .logo { height: 90px; }

    .header-text {
      font-size: 14px;
      line-height: 1.3;
      font-weight: bold;
    }

    /* ===== SERTIFIKAT (DESKTOP) ===== */
    .certificate {
      background: #fff;
      border-radius: 16px;
      padding: 30px 25px;
      text-align: center;
      max-width: 600px;
      width: 100%;
    }

    .certificate h1 {
      font-size: 26px;
      margin-bottom: 8px;
      color: #000;
    }

    .certificate p {
      font-size: 15px;
      margin: 8px 0;
      color: #000;
    }

    .name {
      font-size: 30px;
      font-weight: bold;
      margin: 15px 0;
      color: #000;
    }

    .btn {
      display: none;
      margin-top: 20px;
      padding: 14px 22px;
      background: #00c6ff;
      color: #000;
      text-decoration: none;
      border-radius: 10px;
      font-weight: bold;
      font-size: 15px;
    }

    .btn:hover { background: #00a2d4; }

    /* ===== MOBIL ===== */
    @media (max-width: 768px) {
      body {
        padding-top: 140px;
        background-position: -230px 80px;
      }

      header {
        position: absolute;
        flex-direction: column;
        align-items: center;
        text-align: center;
        padding: 5px 10px;
        background: rgba(15, 45, 58, 0.65);
      }

      .certificate {
        background: rgba(255,255,255,0.2);
        backdrop-filter: blur(4px);
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0,0,0,0.25);
      }

      .certificate h1,
      .certificate .name,
      .certificate p {
        color: #ffe600;
        text-shadow: 0 2px 6px rgba(0,0,0,0.5);
      }
    }
  </style>
</head>

<body>

<header>
  <img src="agmk-logo.png" class="logo">
  <div class="header-text">
    ‚ÄúOLMALIQ KON-METALLURGIYA KOMBINATI‚Äù<br>
    AKSIYADORLIK JAMIYATI<br>
    O'QUV MARKAZI MUHANDISLIK MAKTABI
  </div>
</header>

<div class="certificate">
  <h1>Yuklanmoqda...</h1>
  <div class="name"></div>
  <p></p>

  <a id="pdfLink" class="btn" target="_blank">
    üìÑ Sertifikatni yuklab olish
  </a>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxkje_TUtAMTzQfgCDIrZ5sHPDVKYeF-bZvVqCbsl0RA8krL5teedcW_9v7_mHsB0Unbg/exec";

const params = new URLSearchParams(window.location.search);
const certId = params.get("id");

fetch(API_URL)
  .then(res => res.json())
  .then(data => {

    if (!certId || !data[certId]) {
      document.querySelector(".certificate").innerHTML = `
        <h1>‚ùå Sertifikat topilmadi</h1>
        <p>ID noto‚Äòg‚Äòri yoki mavjud emas</p>
      `;
      return;
    }

    const cert = data[certId];

    document.querySelector("h1").innerText = cert.course;
    document.querySelector(".name").innerText = cert.name;
    document.querySelector(".certificate p").innerText =
      "Muhandislik kursini muvaffaqiyatli yakunlagani uchun";

    const d = new Date(cert.date);
    const date =
      String(d.getDate()).padStart(2,'0') + "." +
      String(d.getMonth()+1).padStart(2,'0') + "." +
      d.getFullYear();

    const status = document.createElement("p");
    status.innerHTML = "‚úÖ <b>Haqiqiy sertifikat</b><br>Berilgan sana: " + date;
    status.style.marginTop = "15px";
    document.querySelector(".certificate").appendChild(status);

    const pdfLink = document.getElementById("pdfLink");
    pdfLink.href = `pdf/${certId}.pdf`;
    pdfLink.style.display = "inline-block";
  });
</script>

</body>
</html>
